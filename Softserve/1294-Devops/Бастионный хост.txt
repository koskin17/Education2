–ü—Ä–∏–≤–µ—Ç! –ß—Ç–æ –∑–Ω–∞—á–∏—Ç –±–∞—Å—Ç–∏–æ–Ω, –∫–æ–≥–¥–∞ –≥–æ–≤–æ—Ä—è—Ç –ø—Ä–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö?
–ü—Ä–∏–≤–µ—Ç! –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —Ç–µ—Ä–º–∏–Ω "–±–∞—Å—Ç–∏–æ–Ω" (–∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π "–±–∞—Å—Ç–∏–æ–Ω–Ω—ã–π —Ö–æ—Å—Ç" –∏–ª–∏ "bastion host") –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å–µ—Ç–µ–≤—ã–º —Ä–µ—Å—É—Ä—Å–∞–º, —Ç–∞–∫–∏–º –∫–∞–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∏–∑ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞:
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ë–∞—Å—Ç–∏–æ–Ω–Ω—ã–π —Ö–æ—Å—Ç –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ —à–ª—é–∑–∞ –º–µ–∂–¥—É –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º) –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Å–µ—Ç—å—é. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç —Ö–æ—Å—Ç, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –±–∞—Å—Ç–∏–æ–Ω–Ω—ã–π —Ö–æ—Å—Ç, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –≤–µ—Å—Ç–∏ —É—á–µ—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º.

–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º —Ö–æ—Å—Ç–µ, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –∫–∞–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–ª–∏ IP-–∞–¥—Ä–µ—Å–∞ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É —Å –ø–æ–º–æ—â—å—é SSH –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.

–ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Ä–µ—Å—É—Ä—Å—É: –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
–ï—Å–ª–∏ –≤–∞—à–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Å–µ—Ç–∏ –∏ –≤–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –Ω–µ–π –∏–∑ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏, –≤—ã —Å–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ—Å—å –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üöÄ

–ê –∫–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–µ—Ç—Å—è –±–∞—Å—Ç–∏–æ–Ω–Ω—ã–π —Ö–æ—Å—Ç?
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å–µ—Ç–µ–≤—ã–º —Ä–µ—Å—É—Ä—Å–∞–º. –í–æ—Ç –ø—Ä–∏–º–µ—Ä–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

–®–∞–≥–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞
–í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞:

–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã—Å—Ç—É–ø–∞—Ç—å –≤ —Ä–æ–ª–∏ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞. –≠—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å —Ö–æ—Ä–æ—à–µ–π –∑–∞—â–∏—Ç–æ–π –∏ –º–æ—â–Ω–æ—Å—Ç—å—é.

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã:

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, Linux (Ubuntu, CentOS –∏ —Ç.–¥.).

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–¥–æ—Å—Ç—É–ø–∞:

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SSH-—Å–µ—Ä–≤–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥:

bash
sudo apt update
sudo apt install openssh-server
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏:

–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH-–∫–ª—é—á–∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

bash
sudo adduser username
sudo mkdir /home/username/.ssh
sudo cp /path/to/public_key /home/username/.ssh/authorized_keys
sudo chown -R username:username /home/username/.ssh
sudo chmod 600 /home/username/.ssh/authorized_keys
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É:

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤:

bash
sudo ufw allow from <trusted-ip> to any port 22
sudo ufw enable
–ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤:

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é –ø–æ—Ä—Ç–æ–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Å–µ—Ä–≤–µ—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

bash
ssh -L 3306:internal-db-server:3306 username@bastion-host
–í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º —Ö–æ—Å—Ç–µ –¥–ª—è –∞—É–¥–∏—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–∞–∫ auditd –∏–ª–∏ rsyslog.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –Ω–µ–º—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º. –ù–∞–ø—Ä–∏–º–µ—Ä:

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É:

bash
ssh username@bastion-host
–ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

bash
ssh -L 3306:internal-db-server:3306 username@bastion-host
–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç:

–í –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É–∫–∞–∂–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ localhost:3306.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã
–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∏ –ø–∞—Ç—á–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (2FA) –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –∑–∞—â–∏—Ç—ã.

–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –±–∞—Å—Ç–∏–æ–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É.